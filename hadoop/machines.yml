
vagrant:
  provider: libvirt
  box: baremettle/ubuntu-14.04

# default variables that can be overridden in the `machines` section
# elements
defaults:
  netmask: 255.255.0.0
  memory: 1024
  cpus: 1
  key_path: ~/.ssh/id_rsa
  domain_name: local
  extra_disks: []
  zk_port: 2181
  openstack_flavor: m1.large
  openstack_image: Ubuntu-14.04-64
  openstack_key_name: gambit
  openstack_public_key: ~/.ssh/id_rsa.pub
  openstack_network: systest-net
  openstack_floating_ip_pool: ext-net
  openstack_security_groups:
    - default
    - hadoop

machines:

  - name: zk1
    ip: 10.0.0.10

  - name: zk2
    ip: 10.0.0.11

  - name: zk3
    ip: 10.0.0.12

  - name: master1
    ip: 10.0.1.10

  - name: master2
    ip: 10.0.1.11

  - name: master3
    ip: 10.0.1.12

  - name: slave1
    ip: 10.0.2.10
    extra_disks:
      - device: vdb
        size: 10G

  - name: slave2
    ip: 10.0.2.11
    extra_disks:
      - device: vdb
        size: 10G

  - name: slave3
    ip: 10.0.2.12
    extra_disks:
      - device: vdb
        size: 10G

  - name: slave4
    ip: 10.0.2.13
    extra_disks:
      - device: vdb
        size: 10G

  - name: slave5
    ip: 10.0.2.14
    extra_disks:
      - device: vdb
        size: 10G

  - name: slave6
    ip: 10.0.2.15
    extra_disks:
      - device: vdb
        size: 10G

  - name: frontend
    ip: 10.0.3.10



inventory:

  # These entries are processed to form the ansible inventory file.
  # lists are used to preserve order in the generated inventory file

  - zookeeper: &zookeener
      - zk1
      - zk2
      - zk3

  - namenodes: &namenodes
      - master1
      - master2

  - journalnodes: &journalnodes
      - master1
      - master2
      - master3

  - historyserver: &historyserver
      - master3

  - datanodes: &datanodes
      - slave1
      - slave2
      - slave3
      - slave4
      - slave5
      - slave6

  - hadoop_nodes:
      ^CONCAT^:
        - [frontend]
        - *namenodes
        - *datanodes
        - *journalnodes
        - *historyserver

  - frontend:
      - frontend


hostvars:
  zk1:
    zk_id: 1
  zk2:
    zk_id: 2
  zk3:
    zk_id: 3


groupvars:
  all:
    hadoop_iface: ansible_eth0
  hadoop_nodes:
    dfs_replication: 3
    zookeeper_hosts:
      "\
      {{ hostvars['zk1'][hadoop_iface].ipv4.address }}:2181,\
      {{ hostvars['zk2'][hadoop_iface].ipv4.address }}:2181,\
      {{ hostvars['zk3'][hadoop_iface].ipv4.address }}:2181\
      "
